s=read.csv("input.csv",sep=",",header=T)# read

r=(as.numeric(t(s[,4:27])))
l = matrix(r,nrow=38,ncol=24,byrow=T)
l[1:24,][which(l[1:24,]<0)]<-(l[which(l[1:24,]<0)]==NA)#判斷負號
l

#s2 <- s  #s list give s2 have new one

o=(apply (l,1,na.rm=T,mean ))# all row value mean
o
e = matrix(o,nrow=1,ncol=38,byrow=T)# give e matrix
e
###############################
k<- c(rep(1:38)) #loop for k :1~38
k                # display k :1~38

for (i in k )    
{
  l[i,][which(is.na(l[i,]))]<-e[1,i]  #for loop full fill value
  
}
l                                    #dispaly s2 list 

#####################################

#NO2, O3, PM2.5, PM10, SO2, AQI

s3 <- l #2008/1/1

n=(apply (l,1,na.rm=T,mean ))
a = matrix(n,nrow=1,ncol=38,byrow=T)
a

######################NO2.1.1
index = 0

NO2.1.1= a[1,6]*1.88  

if(NO2.1.1 <=67)
{NO2.1.1=index = 1}

if(NO2.1.1 >=68&NO2.1.1<=134 )
{NO2.1.1=index = 2}

if(NO2.1.1 >=135& NO2.1.1<=200 )
{NO2.1.1=index = 3}

if(NO2.1.1 >=201& NO2.1.1<=267 )
{NO2.1.1=index = 4}

if(NO2.1.1 >=268& NO2.1.1<=334 )
{NO2.1.1=index = 5}

if(NO2.1.1 >=335& NO2.1.1<=400 )
{NO2.1.1=index = 6}

if(NO2.1.1 >=401& NO2.1.1<=467 )
{NO2.1.1=index = 7}

if(NO2.1.1 >=468& NO2.1.1<=534 )
{NO2.1.1=index = 8}

if(NO2.1.1 >=535& NO2.1.1<=600 )
{NO2.1.1=index = 9}

if(NO2.1.1 >=601 )
{NO2.1.1=index = 10}

A1<-NO2.1.1           
######################NO2.1.1

######################PM10.1.1

PM10.1.1= a[1,9]

if(PM10.1.1 <=16)
{PM10.1.1=index = 1}

if(PM10.1.1 >=17& PM10.1.1<=33 )
{PM10.1.1=index = 2}

if(PM10.1.1 >=34& PM10.1.1<=50 )
{PM10.1.1=index = 3}

if(PM10.1.1 >=51& PM10.1.1<=58 )
{PM10.1.1=index = 4}

if(PM10.1.1 >=59& PM10.1.1<=66 )
{PM10.1.1=index = 5}

if(PM10.1.1 >=67& PM10.1.1<=75 )
{PM10.1.1=index = 6}

if(PM10.1.1 >=76& PM10.1.1<=83 )
{PM10.1.1=index = 7}

if(PM10.1.1 >=84& PM10.1.1<=91 )
{PM10.1.1=index = 8}

if(PM10.1.1 >=92& PM10.1.1<=100 )
{PM10.1.1=index = 9}

if(PM10.1.1 >=101 )
{PM10.1.1=index = 10}

B1<- PM10.1.1

######################PM10.1.1

######################PM2.5.1.1

PM2.5.1.1= a[1,10]

if(PM2.5.1.1 <=11)
{PM2.5.1.1=index = 1}

if(PM2.5.1.1 >=12& PM2.5.1.1<=23 )
{PM2.5.1.1=index = 2}

if(PM2.5.1.1 >=24& PM2.5.1.1<=35 )
{PM2.5.1.1=index = 3}

if(PM2.5.1.1 >=36& PM2.5.1.1<=41 )
{PM2.5.1.1=index = 4}

if(PM2.5.1.1 >=42& PM2.5.1.1<=47 )
{PM2.5.1.1=index = 5}

if(PM2.5.1.1 >=48& PM2.5.1.1<=53 )
{PM2.5.1.1=index = 6}

if(PM2.5.1.1 >=54& PM2.5.1.1<=58 )
{PM2.5.1.1=index = 7}

if(PM2.5.1.1 >=59& PM2.5.1.1<=64 )
{PM2.5.1.1=index = 8}

if(PM2.5.1.1 >=65& PM2.5.1.1<=70 )
{PM2.5.1.1=index = 9}

if(PM2.5.1.1 >=71 )
{PM2.5.1.1=index = 10}

C1<-PM2.5.1.1

######################PM2.5.1.1

######################SO2

SO2.1.1= a[1,14]*2.62

if(SO2.1.1 <=88)
{SO2.1.1=index = 1}

if(SO2.1.1 >=89&SO2.1.1<=177 )
{SO2.1.1=index = 2}

if(SO2.1.1 >=178& SO2.1.1<=266 )
{SO2.1.1=index = 3}

if(SO2.1.1 >=267& SO2.1.1<=354 )
{SO2.1.1=index = 4}

if(SO2.1.1 >=355& SO2.1.1<=443 )
{SO2.1.1=index = 5}

if(SO2.1.1 >=444& SO2.1.1<=532 )
{SO2.1.1=index = 6}

if(SO2.1.1 >=533& SO2.1.1<=710 )
{SO2.1.1=index = 7}

if(SO2.1.1 >=711& SO2.1.1<=887 )
{SO2.1.1=index = 8}

if(SO2.1.1 >=888& SO2.1.1<=1064 )
{SO2.1.1=index = 9}

if(SO2.1.1 >=1065 )
{SO2.1.1=index = 10}

D1<-SO2.1.1

######################SO2.1.1
#####################O3.1.1
O3.1.1=(c(mean((l[8,1]):(l[8,8])),mean((l[8,2]):(l[8,9])),mean((l[8,3]):(l[8,10])),mean((l[8,4]):(l[8,11])),mean((l[8,5]):(l[8,12])),mean((l[8,6]):(l[8,13])),mean((l[8,7]):(l[8,14])),mean((l[8,8]):(l[8,15])),mean((l[8,9]):(l[8,16])),mean((l[8,10]):(l[8,17])),mean((l[8,11]):(l[8,18])),mean((l[8,12]):(l[8,19])),mean((l[8,13]):(l[8,20])),mean((l[8,14]):(l[8,21])),mean((l[8,15]):(l[8,22])),mean((l[8,16]):(l[8,23])),mean((l[8,17]):(l[8,24]))))*2
O3.1.1<-max(O3.1.1)
if(O3.1.1 <=33)
{O3.1.1=index = 1}

if(O3.1.1 >=34&O3.1.1<=66 )
{O3.1.1=index = 2}

if(O3.1.1 >=67& O3.1.1<=100 )
{O3.1.1=index = 3}

if(O3.1.1 >=101& O3.1.1<=120 )
{O3.1.1=index = 4}

if(O3.1.1 >=121& O3.1.1<=140 )
{O3.1.1=index = 5}

if(O3.1.1 >=141& O3.1.1<=160 )
{O3.1.1=index = 6}

if(O3.1.1 >=161& O3.1.1<=187 )
{O3.1.1=index = 7}

if(O3.1.1 >=188& O3.1.1<=213 )
{SO2.1.1=index = 8}

if(O3.1.1 >=214& O3.1.1<=240 )
{O3.1.1=index = 9}

if(O3.1.1 >=241 )
{O3.1.1=index = 10}

E1<-O3.1.1

#####################O3(problem)


AQI1 = max(A1,B1,C1,D1)##########AQI1

###################################################

#2008/1/2

######################NO2.1.2
NO2.1.2= a[1,25]*1.88  

if(NO2.1.2 <=67)
{NO2.1.2=index = 1}

if(NO2.1.2 >=68&NO2.1.2<=134 )
{NO2.1.2=index = 2}

if(NO2.1.2 >=135& NO2.1.2<=200 )
{NO2.1.2=index = 3}

if(NO2.1.2 >=201& NO2.1.2<=267 )
{NO2.1.2=index = 4}

if(NO2.1.2 >=268& NO2.1.2<=334 )
{NO2.1.2=index = 5}

if(NO2.1.2 >=335& NO2.1.2<=400 )
{NO2.1.2=index = 6}

if(NO2.1.2 >=401& NO2.1.2<=467 )
{NO2.1.2=index = 7}

if(NO2.1.2 >=468& NO2.1.2<=534 )
{NO2.1.2=index = 8}

if(NO2.1.2 >=535& NO2.1.2<=600 )
{NO2.1.2=index = 9}

if(NO2.1.2 >=601 )
{NO2.1.2=index = 10}

A2<-NO2.1.2           
######################NO2.1.2
######################O3.1.2
O3.1.2=(c(mean((l[27,1]):(l[27,8])),mean((l[27,2]):(l[27,9])),mean((l[27,3]):(l[27,10])),mean((l[27,4]):(l[27,11])),mean((l[27,5]):(l[27,12])),mean((l[27,6]):(l[27,13])),mean((l[27,7]):(l[27,14])),mean((l[27,8]):(l[27,15])),mean((l[27,9]):(l[27,16])),mean((l[27,10]):(l[27,17])),mean((l[27,11]):(l[27,18])),mean((l[27,12]):(l[27,19])),mean((l[27,13]):(l[27,20])),mean((l[27,14]):(l[27,21])),mean((l[27,15]):(l[27,22])),mean((l[27,16]):(l[27,23])),mean((l[27,17]):(l[27,24]))))*2
O3.1.2<-max(O3.1.2)


#O3.1.2=(mean(c(mean((s[27,]$X1):(s[27,]$X8)),mean((s[27,]$X2):(s[27,]$X9)),mean((s[27,]$X3):(s[27,]$X10)),mean((s[27,]$X4):(s[27,]$X11)),mean((s[27,]$X5):(s[27,]$X12)),mean((s[27,]$X6):(s[27,]$X13)),mean((s[27,]$X7):(s[27,]$X14)),mean((s[27,]$X8):(s[27,]$X15)),mean((s[27,]$X9):(s[27,]$X16)),mean((s[27,]$X10):(s[27,]$X17)),mean((s[27,]$X11):(s[27,]$X18)),mean((s[27,]$X12):(s[27,]$X19)),mean((s[27,]$X13):(s[27,]$X20)),mean((s[27,]$X14):(s[27,]$X21)),mean((s[27,]$X15):(s[27,]$X22)),mean((s[27,]$X16):(s[27,]$X23)),mean((s[27,]$X17):(s[27,]$X24)))))*2

if(O3.1.2 <=33)
{O3.1.2=index = 1}

if(O3.1.2 >=34&O3.1.2<=66 )
{O3.1.2=index = 2}

if(O3.1.2 >=67& O3.1.2<=100 )
{O3.1.2=index = 3}

if(O3.1.2 >=101& O3.1.2<=120 )
{O3.1.2=index = 4}

if(O3.1.2 >=121& O3.1.2<=140 )
{O3.1.2=index = 5}

if(O3.1.2 >=141& O3.1.2<=160 )
{O3.1.2=index = 6}

if(O3.1.2 >=161& O3.1.2<=187 )
{O3.1.2=index = 7}

if(O3.1.2 >=188& O3.1.2<=213 )
{O3.1.2=index = 8}

if(O3.1.2 >=214& O3.1.2<=240 )
{O3.1.1=index = 9}

if(O3.1.2 >=241 )
{O3.1.2=index = 10}

E2<-O3.1.2


######################PM10.1.2
PM10.1.2= a[1,28]

if(PM10.1.2 <=16)
{PM10.1.2=index = 1}

if(PM10.1.2 >=17& PM10.1.2<=33 )
{PM10.1.2=index = 2}

if(PM10.1.2 >=34& PM10.1.2<=50 )
{PM10.1.2=index = 3}

if(PM10.1.2 >=51& PM10.1.2<=58 )
{PM10.1.2=index = 4}

if(PM10.1.2 >=59& PM10.1.2<=66 )
{PM10.1.2=index = 5}

if(PM10.1.2 >=67& PM10.1.2<=75 )
{PM10.1.2=index = 6}

if(PM10.1.2 >=76& PM10.1.2<=83 )
{PM10.1.2=index = 7}

if(PM10.1.2 >=84& PM10.1.2<=91 )
{PM10.1.2=index = 8}

if(PM10.1.2 >=92& PM10.1.2<=100 )
{PM10.1.2=index = 9}

if(PM10.1.2 >=101 )
{PM10.1.2=index = 10}

B2<-PM10.1.2
######################PM10.1.2

######################PM2.5.2

PM2.5.1.2= a[1,29]

if(PM2.5.1.2 <=11)
{PM2.5.1.2=index = 1}

if(PM2.5.1.2 >=12& PM2.5.1.2<=23 )
{PM2.5.1.2=index = 2}

if(PM2.5.1.2 >=24& PM2.5.1.2<=35 )
{PM2.5.1.2=index = 3}

if(PM2.5.1.2 >=36& PM2.5.1.2<=41 )
{PM2.5.1.2=index = 4}

if(PM2.5.1.2 >=42& PM2.5.1.2<=47 )
{PM2.5.1.2=index = 5}

if(PM2.5.1.2 >=48& PM2.5.1.2<=53 )
{PM2.5.1.2=index = 6}

if(PM2.5.1.2 >=54& PM2.5.1.2<=58 )
{PM2.5.1.2=index = 7}

if(PM2.5.1.2 >=59& PM2.5.1.2<=64 )
{PM2.5.1.2=index = 8}

if(PM2.5.1.2 >=65& PM2.5.1.2<=70 )
{PM2.5.1.2=index = 9}

if(PM2.5.1.2 >=71 )
{PM2.5.1.2=index = 10}

C2<-PM2.5.1.2
######################PM2.5.2

#######################SO2.1.2

SO2.1.2= a[1,33]*2.62

if(SO2.1.2 <=88)
{SO2.1.2=index = 1}

if(SO2.1.2 >=89&SO2.1.2<=177 )
{SO2.1.2=index = 2}

if(SO2.1.2 >=178& SO2.1.2<=266 )
{SO2.1.2=index = 3}

if(SO2.1.2 >=267& SO2.1.2<=354 )
{SO2.1.2=index = 4}

if(SO2.1.2 >=355& SO2.1.2<=443 )
{SO2.1.2=index = 5}

if(SO2.1.2 >=444& SO2.1.2<=532 )
{SO2.1.2=index = 6}

if(SO2.1.2 >=533& SO2.1.2<=710 )
{SO2.1.2=index = 7}

if(SO2.1.2 >=711& SO2.1.2<=887 )
{SO2.1.2=index = 8}

if(SO2.1.2 >=888& SO2.1.2<=1064 )
{SO2.1.2=index = 9}

if(SO2.1.2 >=1065 )
{SO2.1.2=index = 10}

D2<-SO2.1.2
#######################SO2.1.2

AQI2= max(A1,B2,C2,D2)

output = data.frame(Data= c("2008/1/1","2008/1/2"),NO2=c(A1,A2),O3=c(E1,E2),PM2.5=c(C1,C2) , PM10 =c(B1,B2) , SO2 =c(D1,D2),AQI =c(AQI1 , AQI2))

#填滿
l

#Convert ug/m3to ppb 
#請助教往上找，在各個汙染數值裡(if判斷)

#AQI
c(AQI1,AQI2)

#輸出
output




